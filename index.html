<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>mp3 Parser - README.md</title>

  <link rel="stylesheet" href="assets/style.css">
  
    
      <style>
        
      </style>
    
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
  <meta name="groc-relative-root" content=""/>
  <meta name="groc-document-path" content="README.md"/>
  
</head>
<body>
  <div id="file-area">
    <div id="meta">
      <code class="file-path">
      
        <a href="https://github.com/biril/mp3-parser/blob/master/README.md">README.md</a>
      
      </code>
    </div>
    <div id="document">
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h1 id="mp3-parser"><a href="#mp3-parser" class="anchor"></a>mp3 Parser</h1><p><a href="https://travis-ci.org/biril/mp3-parser"><img src="https://travis-ci.org/biril/mp3-parser.png" alt="Build Status"></a>
<a href="http://badge.fury.io/js/mp3-parser"><img src="https://badge.fury.io/js/mp3-parser.png" alt="NPM version"></a>
<a href="http://badge.fury.io/bo/mp3-parser"><img src="https://badge.fury.io/bo/mp3-parser.png" alt="Bower version"></a></p>
<p>Locate and read MPEG audio file sections: Individual frames as well as ID3v2 and Xing/Lame tags. For
any of these found within a given buffer, mp3 Parser will provide data indicating their presence,
their position within the buffer, as well as relevant informative data (with varying degrees of
detail).</p>
<h2 id="set-up"><a href="#set-up" class="anchor"></a>Set up</h2><p>To use mp3 Parser</p>
<ul>
<li>install with bower, <code>bower install mp3-parser</code> or</li>
<li>install with npm, <code>npm install mp3-parser</code> or</li>
<li>just include the relevant files (see below), in case you&#39;re targeting a browser and don&#39;t want to
  go over npm or bower.</li>
</ul>
<p>mp3 Parser may be used as a CommonJS module on Node or in a browser, either as an AMD module or
through plain <code>&lt;script&gt;</code> tags. It&#39;s automatically exported in the appropriate format depending on
the current environment:</p>
<ul>
<li><p>When working <em>with CommonJS</em> (e.g. Node), assuming mp3 Parser is <code>npm install</code>ed:</p>
<pre><code class="lang-javascript">  <span class="hljs-keyword">var</span> mp3Parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mp3-parser"</span>);
  <span class="hljs-keyword">var</span> mp3Tags = mp3Parser.readTags(someMp3DataView);
</code></pre>
</li>
<li><p>When working <em>with an AMD loader</em> (e.g. requireJS):</p>
<pre><code class="lang-javascript">  <span class="hljs-comment">// Your module</span>
  define([<span class="hljs-string">"path/to/mp3-parser/main"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mp3Parser</span>) </span>{
      <span class="hljs-keyword">var</span> mp3Tags = mp3Parser.readTags(someMp3DataView);
  });
</code></pre>
<p>  In the example above, it is assumed that mp3-parser source files live in
  <code>path/to/mp3-parser</code> (relative to the root path used for module lookups). When using requireJS
  you may prefer to <a href="http://requirejs.org/docs/api.html#packages">treat mp3-parser as a package</a>:</p>
<pre><code class="lang-javascript">  <span class="hljs-comment">// Configure requireJS for the mp3-parser package ..</span>
  <span class="hljs-built_in">require</span>.config({
      packages: [{
          name: <span class="hljs-string">"mp3-parser"</span>,
          location: <span class="hljs-string">"path/to/mp3-parser"</span>
      }]
  })

  <span class="hljs-comment">// .. and refer to mp3-parser module by its given package name</span>
  define([<span class="hljs-string">"mp3-parser"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mp3Parser</span>) </span>{
      <span class="hljs-keyword">var</span> mp3Tags = mp3Parser.readTags(someMp3DataView);
  });
</code></pre>
</li>
</ul>
<ul>
<li><p>Setting up mp3 Parser in projects targetting <em>browsers, without an AMD module loader</em>, is
  unfortunately quite verbose as it relies on the (order-specific) inclusion of a number of
  sources. This should be mitigated in the future, but for now you would need:</p>
<pre><code class="lang-html">  ...
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"path/to/mp3-parser/lib/lib.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"path/to/mp3-parser/lib/xing.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"path/to/mp3-parser/lib/id3v2.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"path/to/mp3-parser/main.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  ...
</code></pre>
<p>  which would export the <code>mp3Parser</code> global:</p>
<pre><code class="lang-javascript">  <span class="hljs-keyword">var</span> mp3Tags = mp3Parser.readTags(someMp3DataView);
</code></pre>
</li>
</ul>
<h2 id="usage"><a href="#usage" class="anchor"></a>Usage</h2><p>The parser&#39;s API consists of <code>read____</code> methods, each dedicated to reading a specific section
of the MPEG audio file. The current implementation includes <code>readFrameHeader</code>, <code>readFrame</code>,
<code>readLastFrame</code>, <code>readId3v2Tag</code>, <code>readXingTag</code> and <code>readTags</code>. Each of these accepts a
<a href="http://www.khronos.org/registry/typedarray/specs/latest/#8">DataView</a>-wrapped ArrayBuffer
containing the audio data, and optionally an offset into the buffer.</p>
<p>In all cases, a &#39;description&#39; will be returned - a hash containing key-value pairs relevant to the
specific section being read. For example, the hash returned by <code>readFrameHeader</code> for an mp3 file
will include an <code>mpegAudioVersion</code> key of value &quot;MPEG Version 1 (ISO/IEC 11172-3)&quot; and a
<code>layerDescription</code> key of value &quot;Layer III&quot;. A section description will always include a
<code>_section</code> attribute - a hash with <code>type</code>, <code>byteLength</code> and <code>offset</code> keys:</p>
<ul>
<li><code>type</code>: &quot;frame&quot;, &quot;frameHeader&quot;, &quot;Xing&quot; or &quot;ID3v2&quot;</li>
<li><code>byteLenfth</code>: Size of the section in bytes</li>
<li><code>offset</code>: Buffer offset at which this section resides</li>
</ul>
<p>In further detail:</p>
<h3 id="readframeheader-view-offset-"><a href="#readframeheader-view-offset-" class="anchor"></a>readFrameHeader(view, [offset])</h3><p>Read and return description of header of frame located at <code>offset</code> of DataView <code>view</code>. Returns
<code>null</code> in the event that no frame header is found at <code>offset</code>.</p>
<p>A couple of example descriptions:</p>
<ul>
<li><p>Version 1, Layer III (mp3), 44.1KHz 128Kbs Joint Stereo:</p>
<pre><code class="lang-javascript">  {
      _section: {
          type: <span class="hljs-string">'frameHeader'</span>,
          offset: <span class="hljs-number">99934</span>,
          byteLength: <span class="hljs-number">4</span>
      },
      mpegAudioVersionBits: <span class="hljs-string">'11'</span>,
      mpegAudioVersion: <span class="hljs-string">'MPEG Version 1 (ISO/IEC 11172-3)'</span>,
      layerDescriptionBits: <span class="hljs-string">'01'</span>,
      layerDescription: <span class="hljs-string">'Layer III'</span>,
      isProtected: <span class="hljs-number">1</span>,
      protectionBit: <span class="hljs-string">'1'</span>,
      bitrateBits: <span class="hljs-string">'1001'</span>,
      bitrate: <span class="hljs-number">128</span>,
      samplingRateBits: <span class="hljs-string">'00'</span>,
      samplingRate: <span class="hljs-number">44100</span>,
      frameIsPaddedBit: <span class="hljs-string">'1'</span>,
      frameIsPadded: <span class="hljs-literal">true</span>,
      framePadding: <span class="hljs-number">1</span>,
      privateBit: <span class="hljs-string">'0'</span>,
      channelModeBits: <span class="hljs-string">'01'</span>,
      channelMode: <span class="hljs-string">'Joint stereo (Stereo)'</span>
  }
</code></pre>
</li>
<li><p>Version 2, Layer II, 16KHz 32Kbs Mono:</p>
<pre><code class="lang-javascript">  {
      _section: {
          type: <span class="hljs-string">'frameHeader'</span>,
          offset: <span class="hljs-number">0</span>,
          byteLength: <span class="hljs-number">4</span>
      },
      mpegAudioVersionBits: <span class="hljs-string">'10'</span>,
      mpegAudioVersion: <span class="hljs-string">'MPEG Version 2 (ISO/IEC 13818-3)'</span>,
      layerDescriptionBits: <span class="hljs-string">'10'</span>,
      layerDescription: <span class="hljs-string">'Layer II'</span>,
      isProtected: <span class="hljs-number">1</span>,
      protectionBit: <span class="hljs-string">'1'</span>,
      bitrateBits: <span class="hljs-string">'0100'</span>,
      bitrate: <span class="hljs-number">32</span>,
      samplingRateBits: <span class="hljs-string">'10'</span>,
      samplingRate: <span class="hljs-number">16000</span>,
      frameIsPaddedBit: <span class="hljs-string">'0'</span>,
      frameIsPadded: <span class="hljs-literal">false</span>,
      framePadding: <span class="hljs-number">0</span>,
      privateBit: <span class="hljs-string">'0'</span>,
      channelModeBits: <span class="hljs-string">'11'</span>,
      channelMode: <span class="hljs-string">'Single channel (Mono)'</span>
  }
</code></pre>
</li>
</ul>
<h3 id="readframe-view-offset-requirenextframe-"><a href="#readframe-view-offset-requirenextframe-" class="anchor"></a>readFrame(view, [offset[, requireNextFrame]])</h3><p>Read and return description of frame located at <code>offset</code> of DataView <code>view</code>. Includes the frame
header description (see <code>readFrameHeader</code>) plus basic information about the frame: The frame&#39;s
length in bytes and the index of the next frame <em>if</em> <code>requireNextFrame</code> is set. In this case, the
presence of a <em>next</em> valid frame will be required for <em>this</em> frame to be regarded as valid. Returns
<code>null</code> in the event that no frame is found at <code>offset</code>.</p>
<p>As an example description:</p>
<pre><code class="lang-javascript">{
    _section: {
        type: <span class="hljs-string">'frame'</span>,
        offset: <span class="hljs-number">99934</span>,
        byteLength: <span class="hljs-number">418</span>,
        sampleLength: <span class="hljs-number">1152</span>,
        nextFrameIndex: <span class="hljs-number">100352</span> <span class="hljs-comment">// Available iff 'requireNextFrame'</span>
    },
    header: { <span class="hljs-comment">/* .. a frame header description .. */</span> }
}
</code></pre>
<h3 id="readlastframe-view-offset-requirenextframe-"><a href="#readlastframe-view-offset-requirenextframe-" class="anchor"></a>readLastFrame(view, [offset[, requireNextFrame]])</h3><p>Locate and return the description of the very last valid frame in given DataView <code>view</code>. The search
is carried out in reverse, from given <code>offset</code> (or the very last octet if <code>offset</code> is omitted) to
the buffer&#39;s beginning. If <code>requireNextFrame</code> is set, the presence of a next valid frame will be
required for any found frame to be regarded as valid (causing the method to essentially return the
next-to-last frame on success). Returns <code>null</code> in the event that no frame is found at <code>offset</code>.</p>
<h3 id="readid3v2tag-view-offset-"><a href="#readid3v2tag-view-offset-" class="anchor"></a>readId3v2Tag(view[, offset])</h3><p>Read and return description of <a href="http://id3.org/id3v2.3.0">ID3v2 Tag</a> located at <code>offset</code> of
DataView <code>view</code>. (This will include any and all
<a href="https://github.com/biril/mp3-parser/wiki">currently supported ID3v2 frames</a> located within the
tag). Returns <code>null</code> in the event that no tag is found at <code>offset</code>.</p>
<p>As an example description:</p>
<pre><code class="lang-javascript">{
    _section: {
        type: <span class="hljs-string">'ID3v2'</span>,
        offset: <span class="hljs-number">0</span>,
        byteLength: <span class="hljs-number">2048</span>
    },
    header: {
        majorVersion: <span class="hljs-number">3</span>,
        minorRevision: <span class="hljs-number">0</span>,
        flagsOctet: <span class="hljs-number">0</span>,
        unsynchronisationFlag: <span class="hljs-literal">false</span>,
        extendedHeaderFlag: <span class="hljs-literal">false</span>,
        experimentalIndicatorFlag: <span class="hljs-literal">false</span>,
        size: <span class="hljs-number">2038</span>
    },
    frames: [{
        header: {
            id: <span class="hljs-string">'TIT2'</span>,
            size: <span class="hljs-number">12</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Title/songname/content description'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'Flight Path'</span>
        }
    }, {
        header: {
            id: <span class="hljs-string">'TPUB'</span>,
            size: <span class="hljs-number">10</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Publisher'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'Planet Mu'</span>
        }
    }, {
        header: {
            id: <span class="hljs-string">'TCON'</span>,
            size: <span class="hljs-number">4</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Content type'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'(3)'</span>
        }
    }, {
        header: {
            id: <span class="hljs-string">'TALB'</span>,
            size: <span class="hljs-number">9</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Album/Movie/Show title'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'Severant'</span>
        }
    }, {
        header: {
            id: <span class="hljs-string">'TRCK'</span>,
            size: <span class="hljs-number">3</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Track number/Position in set'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'11'</span>
        }
    }, {
        header: {
            id: <span class="hljs-string">'TYER'</span>,
            size: <span class="hljs-number">5</span>,
            flagsOctet1: <span class="hljs-number">0</span>,
            flagsOctet2: <span class="hljs-number">0</span>
        },
        name: <span class="hljs-string">'Year'</span>,
        content: {
            encoding: <span class="hljs-number">0</span>,
            value: <span class="hljs-string">'2011'</span>
        }
    }, {
        <span class="hljs-comment">/* .. more frames follow .. */</span>
    }]
}
</code></pre>
<h3 id="readxingtag-view-offset-"><a href="#readxingtag-view-offset-" class="anchor"></a>readXingTag(view[, offset])</h3><p>Read and return description of <a href="http://gabriel.mp3-tech.org/mp3infotag.html">Xing / Lame Tag</a>
located at <code>offset</code> of DataView <code>view</code>. Returns <code>null</code> in the event that no frame is found at
<code>offset</code>.</p>
<p>As an example description:</p>
<pre><code class="lang-javascript">{
    _section: {
        type: <span class="hljs-string">'Xing'</span>,
        offset: <span class="hljs-number">2462</span>,
        byteLength: <span class="hljs-number">417</span>,
        nextFrameIndex: <span class="hljs-number">2879</span>
    },
    header: { <span class="hljs-comment">/* .. a frame header description .. */</span> },
    identifier: <span class="hljs-string">'Xing'</span> <span class="hljs-comment">// Or 'Info' if Lame tag</span>
}
</code></pre>
<h3 id="readtags-view-offset-"><a href="#readtags-view-offset-" class="anchor"></a>readTags(view[, offset])</h3><p>Read and return descriptions of all tags found up to (and additionally including) the very first
frame. Returns an array of descriptions which may include that of a located ID3V2 tag, of a located
Xing / Lame tag and of a located first frame.</p>
<h2 id="you-may-also-want-to"><a href="#you-may-also-want-to" class="anchor"></a>You may also want to</h2><ul>
<li>View the <a href="http://biril.github.io/mp3-parser/">annotated version of the source</a>.</li>
<li>Try out the <a href="https://github.com/biril/mp3-parser/tree/0.3.0/example/load-remote">load remote</a>,
  <a href="https://github.com/biril/mp3-parser/tree/0.3.0/example/read-file">read file</a>
  &amp; <a href="https://github.com/biril/mp3-parser/tree/0.3.0/example/cmd-line-parse">cmd line parse</a> examples.</li>
<li>Take a look at <a href="https://github.com/biril/mp3-parser/wiki">the project&#39;s wiki</a> which contains a
  list of currently (un)supported ID3v2 tag frames.</li>
</ul>
<h2 id="contributing"><a href="#contributing" class="anchor"></a>Contributing</h2><p>Contibutions are appreciated, naturally. Feel free to submit pull requests against <code>master</code>. Please
make sure that <code>npm run lint</code> and <code>npm test</code> are green before you do so. Pull requests featuring
appropriate unit tests are ideal. However, less than ideal pull requests are also fine, especially
until the test suite gets the documentation it deserves - probably along with some necessary
housekeeping.</p>
<h2 id="changelog"><a href="#changelog" class="anchor"></a>Changelog</h2><h4 id="next-diff"><a href="#next-diff" class="anchor"></a>Next — <a href="https://github.com/biril/mp3-parser/compare/0.3.0...master">Diff</a></h4><p>TBD</p>
<h4 id="0-3-0-nov-20-2016-diff"><a href="#0-3-0-nov-20-2016-diff" class="anchor"></a>0.3.0 — <em>Nov 20, 2016</em> — <a href="https://github.com/biril/mp3-parser/compare/0.2.7...0.3.0">Diff</a></h4><ul>
<li>Add support for ID3v2 CHAP frames (Thanks <a href="https://github.com/markusahlstrand">markusahlstrand</a>).</li>
<li>Add support for MPEG v2 / layers I - III (Thanks <a href="https://github.com/jdelStrother">jdelStrother</a>).</li>
<li>Fix ID3v2 IPLS frame parsing defect (fixes <a href="https://github.com/biril/mp3-parser/issues/4">issue #4</a>, probably maybe).</li>
<li>Improve test-runner (switch to Jasmine). Add tests. Revise and clean-up linter config.</li>
<li>Lots of minor fixes and housekeeping.</li>
</ul>
<h2 id="license"><a href="#license" class="anchor"></a>License</h2><p>Licensed and freely distributed under the MIT License (LICENSE.txt).</p>
<p>Copyright (c) 2013-2016 Alex Lambiris</p>
</div>
        </div>
      
      
      </div>
    
    </div>
  </div>

  <script src="toc.js"></script>
  <script src="assets/libs.js"></script>
  <script src="assets/behavior.js"></script>

  
    
      <script>
        
      </script>
    
  
</body>
</html>